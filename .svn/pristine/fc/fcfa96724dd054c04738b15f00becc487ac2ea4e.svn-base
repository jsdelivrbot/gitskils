<template>
  <div class="xwzx_div_mai">
    <app-header title="新闻资讯"></app-header>

    <div class="xwzx_list" :style="pageh">
      <div class="xwzx_nullData" v-if='!XcsList.length'>暂无数据</div>
      <mt-loadmore :auto-fill="false" :top-method="loadTop" :bottom-method="loadBottom" :bottom-all-loaded="allLoaded" ref="loadmore" :top-distance='10'>
        <router-link class="xwzx_list_item" v-for="(item, index) in XcsList" :to='item.path' :key="index">
          <div>
            <div>
              <li>{{item.title}}</li>
              <li class="fa fa-angle-right"></li>
            </div>
            <div class="clear" style="height: 0"></div>
            <div>
              <li>{{item.sensePubDateString}}</li>
            </div>
            </div>
        </router-link>
      <div style="height: 32px;line-height: 32px;" v-if='XcsList.length && allLoaded'>已加载到底部</div>
      </mt-loadmore>
    </div>
  </div>

</template>

<script>
  import { Tool } from "../../utils/tool.js" ;
  import AppHeader from "@/components/HeaderComponent";
  import { httpGetMethod,State } from "../../utils/api.js"; //添加公共组件
  import { Loadmore } from 'mint-ui';
  export default {
    name: 'XwzxComponent',
    data: function() {
      return {
        XcsList:[],
        pageh: {
          height: State().wh - 44 + "px"
        },
        allLoaded: false,
        popupVisible:false,
        activeName: '全部',
        sxtj:[],
        PageSize: 20,
        RowNum: 0,
      }
    },
    components: {
      AppHeader,
      Loadmore
    },
    methods: {
      loadTop: function() {
        let self = this;
        this.RowNum = 0;
        this.getdata(function(lt) {
          self.XcsList = [];
          lt.forEach(function(item) {
            item.path = "/ylbxdetail/40/" + item.noticeCode;
            self.XcsList.push(item);
          });
          self.allLoaded = false;
          self.$refs.loadmore.onTopLoaded();
          if(lt.length < self.PageSize) {
            self.allLoaded = true;
          }
        }, true);
      },
      loadBottom: function() {
        let self = this;
        this.RowNum++;
        this.getdata(function(lt) {
          self.$refs.loadmore.onBottomLoaded();
          if(lt.length < self.PageSize) {
            self.allLoaded = true;
          }
        }, true);
      },
      getdata: function (fun, isshowload) {
        let self = this;
        httpGetMethod("hrs-ess/app/getNoticeList.action?", {
          RowNum: self.RowNum,
          PageSize: self.PageSize
        },function(result) {
          result.data.forEach(function(item) {
            item.path = "/ylbxdetail/40/" + item.noticeCode;
            self.XcsList.push(item);
          });

          if(fun) {
            fun(result.data)
          }
        }, function() {}, isshowload);
      }
    },
    mounted: function() {
      let self = this;
      this.getdata(function(lt){
        if(lt.length < self.PageSize) {
          self.allLoaded = true;
        }
      });
    }
  }
</script>

<style>
  .xwzx_nullData {
    height: 32px;
    line-height: 32px;
  }

  .button_gray {
    border-radius: 0 !important;
  }

  .button_blue {
    background-color: #3d74d9 !important;
    border-radius: 0 !important;
  }

  li{
    list-style: none;
  }

  .clear{
    clear: both;
  }

  .xwzx_list {
    overflow-y: auto;
    background: #f5f5f5;
  }

  .xwzx_list_item {
    display: block;
    background:  #fff;
    color: #505050;
  }

  .xwzx_list .xwzx_list_item:nth-child(odd) {
    background: #fcfcfd;
  }

  .xwzx_list .xwzx_list_item:nth-child(even) {
    background: white;
  }

  .xwzx_list .xwzx_list_item {
    border-bottom: 1px solid #f4f4f4;
    height: 64px;
  }

  .xwzx_list .Xcslist:nth-child(1) {
    border-top: 1px solid #f4f4f4;
  }

  .xwzx_list_item>div {
    width: 90%;
    height: 55px;
    margin: 0 auto;
    text-align: left;
  }

  .xwzx_list_item>div div {
    width: 100%;
    height: 20px;
  }

  .xwzx_list_item>div div:nth-child(1) li:nth-child(1) {
    float: left;
    font-size: 14px;
    padding-top: 7px;
    line-height: 25px;
    overflow: hidden;
    display: -webkit-box;
    text-overflow: ellipsis;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    max-width: 95%;
  }

  .xwzx_list_item>div div:nth-child(1) li:nth-child(2) {
    float: right;
    font-size: 20px;
    padding-top: 4px;
  }

  .xwzx_list_item>div div:nth-child(3) li {
    float: right;
    padding-top: 3px;
    color: #b8b8b8;
    font-size: 13px;
  }
/*
  .xwzx_list_item>div div:nth-child(3) li:nth-child(2) {
    float: right;
    padding-top: 3px;
    color: #b8b8b8;
  }*/

</style>
